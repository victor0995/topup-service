2025-12-05 09:50:59 [main] INFO  u.u.t.TopupServiceApplication - Starting TopupServiceApplication using Java 17.0.13 with PID 20980 (C:\Users\pakvi\Desktop\work\work\topup-service\target\classes started by pakvi in C:\Users\pakvi\Desktop\work\work\topup-service)
2025-12-05 09:50:59 [main] INFO  u.u.t.TopupServiceApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-05 09:51:00 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Cassandra repositories in DEFAULT mode.
2025-12-05 09:51:00 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 Cassandra repository interfaces.
2025-12-05 09:51:00 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Cassandra repositories in DEFAULT mode.
2025-12-05 09:51:00 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Reactive Cassandra repository interfaces.
2025-12-05 09:51:00 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Cassandra repositories in DEFAULT mode.
2025-12-05 09:51:00 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Cassandra repository interfaces.
2025-12-05 09:51:01 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-05 09:51:01 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-05 09:51:01 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.20]
2025-12-05 09:51:01 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-05 09:51:01 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1533 ms
2025-12-05 09:51:01 [main] INFO  u.u.topupservice.config.TopupConfig - ==== Topup service configuration ====
2025-12-05 09:51:01 [main] INFO  u.u.topupservice.config.TopupConfig - Cassandra: contactPoints=127.0.0.1, port=9042, username=cassandra, keyspace=vasp, dc=datacenter1
2025-12-05 09:51:01 [main] INFO  u.u.topupservice.config.TopupConfig - RabbitMQ: host=localhost, port=5672, username=guest, exchange=exchange, queueTermination=billing.charge.queue, routingKeyTermination=billing.charge.queue
2025-12-05 09:51:01 [main] INFO  u.u.topupservice.config.TopupConfig - CBS broker: url=, user=, exchangeType=, exchangeTypeAlt=
2025-12-05 09:51:01 [main] INFO  c.d.o.d.i.c.DefaultMavenCoordinates - DataStax Java driver for Apache Cassandra(R) (com.datastax.oss:java-driver-core) version 4.17.0
2025-12-05 09:51:02 [main] INFO  c.d.o.d.i.c.c.CqlPrepareAsyncProcessor - Adding handler to invalidate cached prepared statements on type changes
2025-12-05 09:51:02 [s0-admin-0] INFO  c.d.o.d.internal.core.time.Clock - Using native clock for microsecond precision
2025-12-05 09:51:02 [s0-admin-1] WARN  c.d.o.d.i.c.c.ControlConnection - [s0] Error connecting to Node(endPoint=127.0.0.1/<unresolved>:9042, hostId=null, hashCode=47f0d9b5), trying next node (ConnectionInitException: [s0|control|id: 0x08caee82, L:/127.0.0.1:65087 - R:/127.0.0.1:9042] Protocol initialization request, step 1 (OPTIONS): unexpected failure (com.datastax.oss.driver.api.core.connection.ClosedConnectionException: Lost connection to remote peer))
2025-12-05 09:51:04 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'cassandraSession' defined in class path resource [uz/ucell/topupservice/cassandra/CassandraConfiguration.class]: Could not reach any contact point, make sure you've provided valid addresses (showing first 1 nodes, use getAllErrors() for more): Node(endPoint=127.0.0.1/<unresolved>:9042, hostId=null, hashCode=47f0d9b5): [com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s0|control|id: 0x08caee82, L:/127.0.0.1:65087 - R:/127.0.0.1:9042] Protocol initialization request, step 1 (OPTIONS): unexpected failure (com.datastax.oss.driver.api.core.connection.ClosedConnectionException: Lost connection to remote peer)]
2025-12-05 09:51:04 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-12-05 09:51:04 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-12-05 09:51:04 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'cassandraSession' defined in class path resource [uz/ucell/topupservice/cassandra/CassandraConfiguration.class]: Could not reach any contact point, make sure you've provided valid addresses (showing first 1 nodes, use getAllErrors() for more): Node(endPoint=127.0.0.1/<unresolved>:9042, hostId=null, hashCode=47f0d9b5): [com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s0|control|id: 0x08caee82, L:/127.0.0.1:65087 - R:/127.0.0.1:9042] Protocol initialization request, step 1 (OPTIONS): unexpected failure (com.datastax.oss.driver.api.core.connection.ClosedConnectionException: Lost connection to remote peer)]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1786)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:969)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:962)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:624)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:334)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at uz.ucell.topupservice.TopupServiceApplication.main(TopupServiceApplication.java:11)
Caused by: com.datastax.oss.driver.api.core.AllNodesFailedException: Could not reach any contact point, make sure you've provided valid addresses (showing first 1 nodes, use getAllErrors() for more): Node(endPoint=127.0.0.1/<unresolved>:9042, hostId=null, hashCode=47f0d9b5): [com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s0|control|id: 0x08caee82, L:/127.0.0.1:65087 - R:/127.0.0.1:9042] Protocol initialization request, step 1 (OPTIONS): unexpected failure (com.datastax.oss.driver.api.core.connection.ClosedConnectionException: Lost connection to remote peer)]
	at com.datastax.oss.driver.api.core.AllNodesFailedException.copy(AllNodesFailedException.java:141)
	at com.datastax.oss.driver.internal.core.util.concurrent.CompletableFutures.getUninterruptibly(CompletableFutures.java:149)
	at com.datastax.oss.driver.api.core.session.SessionBuilder.build(SessionBuilder.java:835)
	at org.springframework.data.cassandra.config.CqlSessionFactoryBean.buildSystemSession(CqlSessionFactoryBean.java:535)
	at org.springframework.data.cassandra.config.CqlSessionFactoryBean.afterPropertiesSet(CqlSessionFactoryBean.java:469)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1833)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1782)
	... 16 common frames omitted
	Suppressed: com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s0|control|id: 0x08caee82, L:/127.0.0.1:65087 - R:/127.0.0.1:9042] Protocol initialization request, step 1 (OPTIONS): unexpected failure (com.datastax.oss.driver.api.core.connection.ClosedConnectionException: Lost connection to remote peer)
		at com.datastax.oss.driver.internal.core.channel.ProtocolInitHandler$InitRequest.fail(ProtocolInitHandler.java:356)
		at com.datastax.oss.driver.internal.core.channel.ChannelHandlerRequest.onFailure(ChannelHandlerRequest.java:104)
		at com.datastax.oss.driver.internal.core.channel.InFlightHandler.fail(InFlightHandler.java:381)
		at com.datastax.oss.driver.internal.core.channel.InFlightHandler.abortAllInFlight(InFlightHandler.java:371)
		at com.datastax.oss.driver.internal.core.channel.InFlightHandler.abortAllInFlight(InFlightHandler.java:353)
		at com.datastax.oss.driver.internal.core.channel.InFlightHandler.channelInactive(InFlightHandler.java:331)
		at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
		at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
		at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
		at io.netty.handler.codec.ByteToMessageDecoder.channelInputClosed(ByteToMessageDecoder.java:412)
		at io.netty.handler.codec.ByteToMessageDecoder.channelInactive(ByteToMessageDecoder.java:377)
		at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
		at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
		at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
		at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
		at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
		at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
		at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
		at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
		at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
		at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)
		at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
		at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:566)
		at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
		at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
		at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
		at java.base/java.lang.Thread.run(Thread.java:840)
	Caused by: com.datastax.oss.driver.api.core.connection.ClosedConnectionException: Lost connection to remote peer
2025-12-05 09:51:14 [main] INFO  u.u.t.TopupServiceApplication - Starting TopupServiceApplication using Java 17.0.13 with PID 27616 (C:\Users\pakvi\Desktop\work\work\topup-service\target\classes started by pakvi in C:\Users\pakvi\Desktop\work\work\topup-service)
2025-12-05 09:51:14 [main] INFO  u.u.t.TopupServiceApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-05 09:51:14 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Cassandra repositories in DEFAULT mode.
2025-12-05 09:51:14 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Cassandra repository interfaces.
2025-12-05 09:51:14 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Cassandra repositories in DEFAULT mode.
2025-12-05 09:51:15 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Reactive Cassandra repository interfaces.
2025-12-05 09:51:15 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Cassandra repositories in DEFAULT mode.
2025-12-05 09:51:15 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Cassandra repository interfaces.
2025-12-05 09:51:15 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-05 09:51:15 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-05 09:51:15 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.20]
2025-12-05 09:51:15 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-05 09:51:15 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 985 ms
2025-12-05 09:51:15 [main] INFO  u.u.topupservice.config.TopupConfig - ==== Topup service configuration ====
2025-12-05 09:51:15 [main] INFO  u.u.topupservice.config.TopupConfig - Cassandra: contactPoints=127.0.0.1, port=9042, username=cassandra, keyspace=vasp, dc=datacenter1
2025-12-05 09:51:15 [main] INFO  u.u.topupservice.config.TopupConfig - RabbitMQ: host=localhost, port=5672, username=guest, exchange=exchange, queueTermination=billing.charge.queue, routingKeyTermination=billing.charge.queue
2025-12-05 09:51:15 [main] INFO  u.u.topupservice.config.TopupConfig - CBS broker: url=, user=, exchangeType=, exchangeTypeAlt=
2025-12-05 09:51:15 [main] INFO  c.d.o.d.i.c.DefaultMavenCoordinates - DataStax Java driver for Apache Cassandra(R) (com.datastax.oss:java-driver-core) version 4.17.0
2025-12-05 09:51:15 [main] INFO  c.d.o.d.i.c.c.CqlPrepareAsyncProcessor - Adding handler to invalidate cached prepared statements on type changes
2025-12-05 09:51:16 [s0-admin-0] INFO  c.d.o.d.internal.core.time.Clock - Using native clock for microsecond precision
2025-12-05 09:51:16 [s0-admin-1] WARN  c.d.o.d.i.c.c.ControlConnection - [s0] Error connecting to Node(endPoint=127.0.0.1/<unresolved>:9042, hostId=null, hashCode=2f5a5795), trying next node (ConnectionInitException: [s0|control|id: 0x9529c293, L:/127.0.0.1:65100 - R:/127.0.0.1:9042] Protocol initialization request, step 1 (OPTIONS): unexpected failure (com.datastax.oss.driver.api.core.connection.ClosedConnectionException: Lost connection to remote peer))
2025-12-05 09:51:18 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'cassandraSession' defined in class path resource [uz/ucell/topupservice/cassandra/CassandraConfiguration.class]: Could not reach any contact point, make sure you've provided valid addresses (showing first 1 nodes, use getAllErrors() for more): Node(endPoint=127.0.0.1/<unresolved>:9042, hostId=null, hashCode=2f5a5795): [com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s0|control|id: 0x9529c293, L:/127.0.0.1:65100 - R:/127.0.0.1:9042] Protocol initialization request, step 1 (OPTIONS): unexpected failure (com.datastax.oss.driver.api.core.connection.ClosedConnectionException: Lost connection to remote peer)]
2025-12-05 09:51:18 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-12-05 09:51:18 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-12-05 09:51:18 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'cassandraSession' defined in class path resource [uz/ucell/topupservice/cassandra/CassandraConfiguration.class]: Could not reach any contact point, make sure you've provided valid addresses (showing first 1 nodes, use getAllErrors() for more): Node(endPoint=127.0.0.1/<unresolved>:9042, hostId=null, hashCode=2f5a5795): [com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s0|control|id: 0x9529c293, L:/127.0.0.1:65100 - R:/127.0.0.1:9042] Protocol initialization request, step 1 (OPTIONS): unexpected failure (com.datastax.oss.driver.api.core.connection.ClosedConnectionException: Lost connection to remote peer)]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1786)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:969)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:962)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:624)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:334)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at uz.ucell.topupservice.TopupServiceApplication.main(TopupServiceApplication.java:11)
Caused by: com.datastax.oss.driver.api.core.AllNodesFailedException: Could not reach any contact point, make sure you've provided valid addresses (showing first 1 nodes, use getAllErrors() for more): Node(endPoint=127.0.0.1/<unresolved>:9042, hostId=null, hashCode=2f5a5795): [com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s0|control|id: 0x9529c293, L:/127.0.0.1:65100 - R:/127.0.0.1:9042] Protocol initialization request, step 1 (OPTIONS): unexpected failure (com.datastax.oss.driver.api.core.connection.ClosedConnectionException: Lost connection to remote peer)]
	at com.datastax.oss.driver.api.core.AllNodesFailedException.copy(AllNodesFailedException.java:141)
	at com.datastax.oss.driver.internal.core.util.concurrent.CompletableFutures.getUninterruptibly(CompletableFutures.java:149)
	at com.datastax.oss.driver.api.core.session.SessionBuilder.build(SessionBuilder.java:835)
	at org.springframework.data.cassandra.config.CqlSessionFactoryBean.buildSystemSession(CqlSessionFactoryBean.java:535)
	at org.springframework.data.cassandra.config.CqlSessionFactoryBean.afterPropertiesSet(CqlSessionFactoryBean.java:469)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1833)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1782)
	... 16 common frames omitted
	Suppressed: com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s0|control|id: 0x9529c293, L:/127.0.0.1:65100 - R:/127.0.0.1:9042] Protocol initialization request, step 1 (OPTIONS): unexpected failure (com.datastax.oss.driver.api.core.connection.ClosedConnectionException: Lost connection to remote peer)
		at com.datastax.oss.driver.internal.core.channel.ProtocolInitHandler$InitRequest.fail(ProtocolInitHandler.java:356)
		at com.datastax.oss.driver.internal.core.channel.ChannelHandlerRequest.onFailure(ChannelHandlerRequest.java:104)
		at com.datastax.oss.driver.internal.core.channel.InFlightHandler.fail(InFlightHandler.java:381)
		at com.datastax.oss.driver.internal.core.channel.InFlightHandler.abortAllInFlight(InFlightHandler.java:371)
		at com.datastax.oss.driver.internal.core.channel.InFlightHandler.abortAllInFlight(InFlightHandler.java:353)
		at com.datastax.oss.driver.internal.core.channel.InFlightHandler.channelInactive(InFlightHandler.java:331)
		at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
		at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
		at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
		at io.netty.handler.codec.ByteToMessageDecoder.channelInputClosed(ByteToMessageDecoder.java:412)
		at io.netty.handler.codec.ByteToMessageDecoder.channelInactive(ByteToMessageDecoder.java:377)
		at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
		at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
		at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
		at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
		at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
		at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
		at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
		at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
		at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
		at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)
		at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
		at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:566)
		at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
		at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
		at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
		at java.base/java.lang.Thread.run(Thread.java:840)
	Caused by: com.datastax.oss.driver.api.core.connection.ClosedConnectionException: Lost connection to remote peer
2025-12-05 09:51:40 [main] INFO  u.u.t.TopupServiceApplication - Starting TopupServiceApplication using Java 17.0.13 with PID 14216 (C:\Users\pakvi\Desktop\work\work\topup-service\target\classes started by pakvi in C:\Users\pakvi\Desktop\work\work\topup-service)
2025-12-05 09:51:40 [main] INFO  u.u.t.TopupServiceApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-05 09:51:40 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Cassandra repositories in DEFAULT mode.
2025-12-05 09:51:40 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Cassandra repository interfaces.
2025-12-05 09:51:40 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Cassandra repositories in DEFAULT mode.
2025-12-05 09:51:40 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Reactive Cassandra repository interfaces.
2025-12-05 09:51:40 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Cassandra repositories in DEFAULT mode.
2025-12-05 09:51:40 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Cassandra repository interfaces.
2025-12-05 09:51:40 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-05 09:51:40 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-05 09:51:40 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.20]
2025-12-05 09:51:40 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-05 09:51:40 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 920 ms
2025-12-05 09:51:41 [main] INFO  u.u.topupservice.config.TopupConfig - ==== Topup service configuration ====
2025-12-05 09:51:41 [main] INFO  u.u.topupservice.config.TopupConfig - Cassandra: contactPoints=127.0.0.1, port=9042, username=cassandra, keyspace=vasp, dc=datacenter1
2025-12-05 09:51:41 [main] INFO  u.u.topupservice.config.TopupConfig - RabbitMQ: host=localhost, port=5672, username=guest, exchange=exchange, queueTermination=billing.charge.queue, routingKeyTermination=billing.charge.queue
2025-12-05 09:51:41 [main] INFO  u.u.topupservice.config.TopupConfig - CBS broker: url=, user=, exchangeType=, exchangeTypeAlt=
2025-12-05 09:51:41 [main] INFO  c.d.o.d.i.c.DefaultMavenCoordinates - DataStax Java driver for Apache Cassandra(R) (com.datastax.oss:java-driver-core) version 4.17.0
2025-12-05 09:51:41 [main] INFO  c.d.o.d.i.c.c.CqlPrepareAsyncProcessor - Adding handler to invalidate cached prepared statements on type changes
2025-12-05 09:51:41 [s0-admin-0] INFO  c.d.o.d.internal.core.time.Clock - Using native clock for microsecond precision
2025-12-05 09:51:41 [s0-io-2] WARN  c.d.o.d.a.c.a.PlainTextAuthProviderBase - [] 127.0.0.1/<unresolved>:9042 did not send an authentication challenge; This is suspicious because the driver expects authentication
2025-12-05 09:51:41 [s0-io-3] WARN  c.d.o.d.a.c.a.PlainTextAuthProviderBase - [] 127.0.0.1/<unresolved>:9042 did not send an authentication challenge; This is suspicious because the driver expects authentication
2025-12-05 09:51:41 [main] INFO  c.d.o.d.i.c.c.CqlPrepareAsyncProcessor - Adding handler to invalidate cached prepared statements on type changes
2025-12-05 09:51:41 [s1-admin-0] INFO  c.d.o.d.internal.core.time.Clock - Using native clock for microsecond precision
2025-12-05 09:51:41 [s1-io-2] WARN  c.d.o.d.a.c.a.PlainTextAuthProviderBase - [] 127.0.0.1/<unresolved>:9042 did not send an authentication challenge; This is suspicious because the driver expects authentication
2025-12-05 09:51:42 [s1-io-3] WARN  c.d.o.d.a.c.a.PlainTextAuthProviderBase - [] 127.0.0.1/<unresolved>:9042 did not send an authentication challenge; This is suspicious because the driver expects authentication
2025-12-05 09:51:42 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-05 09:51:42 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-12-05 09:51:42 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost]
2025-12-05 09:51:42 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: connectionFactory#53e28097:0/SimpleConnection@6b630d4b [delegate=amqp://guest@127.0.0.1:5672/, localPort=65132]
2025-12-05 09:51:42 [main] INFO  o.s.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (billing.charge.queue) durable:false, auto-delete:true, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-12-05 09:51:43 [main] INFO  u.u.t.TopupServiceApplication - Started TopupServiceApplication in 3.362 seconds (process running for 3.784)
2025-12-05 09:51:43 [RMI TCP Connection(2)-26.121.24.245] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-05 09:52:18 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  u.u.t.service.Impl.TopupServiceImpl - Topup request: TopupRequest(p_MSISDN=, p_RECEIPT_NUM=5711450450, p_ACCOUNT=1446811789, p_PAY_AMOUNT=40000, p_PAY_AMOUNT_CURR=40000, p_PAY_CURR=UZS, p_RATE_EXCH=1, p_DATE=Tue Nov 18 23:29:35 UZT 2025, p_DATE2=Tue Nov 18 23:29:35 UZT 2025, p_PAY_TYPE=1, p_WARRANTOR=, p_COMMENT=29539~Saloxiddin.Maxmud~A|1446811789, p_SALE_POINT=2062, p_AGENT_CODE=FO_2062, p_TERMINAL=172.26.0.88, p_ADDINFO3=, p_RESELLER_ID=29539, p_MESSAGE_DATE=Tue Nov 18 23:29:35 UZT 2025, v_EVENT_TIME=Tue Nov 18 23:29:35 UZT 2025, v_REQUEST_TIMEOUT=15, p_PAY_VAT=4285.714286, p_BIS_BALANCE=120005)
2025-12-05 09:53:36 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  u.u.t.service.Impl.TopupServiceImpl - Topup request: TopupRequest(p_MSISDN=, p_RECEIPT_NUM=5711450450, p_ACCOUNT=1446811789, p_PAY_AMOUNT=40000, p_PAY_AMOUNT_CURR=40000, p_PAY_CURR=UZS, p_RATE_EXCH=1, p_DATE=Tue Nov 18 23:29:35 UZT 2025, p_DATE2=Tue Nov 18 23:29:35 UZT 2025, p_PAY_TYPE=1, p_WARRANTOR=, p_COMMENT=29539~Saloxiddin.Maxmud~A|1446811789, p_SALE_POINT=2062, p_AGENT_CODE=FO_2062, p_TERMINAL=172.26.0.88, p_ADDINFO3=, p_RESELLER_ID=29539, p_MESSAGE_DATE=Tue Nov 18 23:29:35 UZT 2025, v_EVENT_TIME=Tue Nov 18 23:29:35 UZT 2025, v_REQUEST_TIMEOUT=15, p_PAY_VAT=4285.714286, p_BIS_BALANCE=120005)
